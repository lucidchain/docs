---
tags: 
  - lucid-chain
  - environment-variables
  - routes
  - configuration
  - architecture
keywords:
  - Lucid Chain frontend
  - Svelte project structure
  - frontend components
  - routing in Svelte
  - environment variables
  - VITE_BACKEND_API configuration
  - npm scripts
  - CI/CD frontend deployment
authors: 
  - name: "Daniel Galván Cancio"
    title: "Project Contributor"
    url: "https://github.com/Dangalcan"
    image_url: "https://avatars.githubusercontent.com/u/92941017"
---

# Lucid chain frontend

import Disclaimer from '@site/src/components/Disclaimer.js';
import Alert from '@site/src/components/Alert.js';

In this section we are going to learn how lucid chain is structured. The first thing you can see when you enter the project, is that there are 2 parts very different from each other. The first one is ***back***. This folder contains all backend logic and the integrations with Redmine and ITop. The other one is ***front***, which contains all the frontend. Here you are about to explore *front* folder in order to understand its content. This is relatively easy to understand and it has a clear structure. It is a simple project developed in Svelte. The main part is in ***src*** folder. In ***components*** we can find all the different frontend reusable and/or complex parts. Some examples are issue tables, piecharts and other artifacts.

<div align="center">
![Frontend structure](/img/structure/frontendStructure.png)  
**Figure 1:** *Lucid chain frontend structure.*
</div>

## Main folder files

As you can see in ***Figure 1*** there are some files that are not in any of the directories. Here we are going to explain all of them.

+ <u>**.env:**</u> This is a special configuration file. In case you have just cloned the repo you will not have it.
+ <u>**.env.example:**</u> This is a example of how your .env file should look like. We will cover enviroment variables later.
+ <u>**.gitignore:**</u> In this file we specify the files that we do not want git to track.
+ <u>**.npmrc:**</u> This is a configuration file used to configure the behavior of npm. In our case, it is better not to change it because it only ensure that npm will strictly enforce the engines specified in package.json.
+ <u>**.prettierignorer:**</u> This file is used to tell Prettier (a code formatter) which files and directories should be ignored so it does not format specified files. You can leave it like that.
+ <u>**.prettierrc:**</u> This file is used to configure Prettier’s formatting rules. In our case there is no need to change the default values.
+ <u>**eslint.config.js:**</u> This file is used to configure ESLint (Lucid chain linter used to develop it). There is no need to change this file unless you want to add or remove linting rules.
+ <u>**package.json:**</u> This file contains all the dependencies. There are some custom scripts in it.
+ <u>**package-lock.json:**</u> This file contains all the project dependencies with its exact versions.
+ <u>**README.md:**</u> This is the default README.md file from svelte projects. In the future we will update it or remove it.
+ <u>**svelte.config.js:**</u> This is a special svelte configuration file. It contains some svelte project configuration. There is no need to change it.
+ <u>**vite.config.js:**</u> This is a special svelte configuration file related with Vite and enviroment variables. There is no need to change it.

<Disclaimer>
***"svelte-kit"*** and ***"node-modules"*** directories are generated automatically and you do not have to worry about them. ***"build"*** directory is also autogenerated but when you run the command ***npm run build***.
</Disclaimer>

## src directory

In src directoty we can find all the interesting and important content. It has all frontend logic. Now let's explore it. The only file here is ***app.html***. Here we import using html some styles. There is no need to change this file unless you would like to import some new libraries in the html.

<div align="center">
![src structure](/img/structure/frontendSrcStructure.png)  
**Figure 2:** *Lucid chain frontend src structure.*
</div>

### components directory

This directory contains all the svelte components of the app. This is where you should have all the new components you design and develop. This make it possile to reuse them and also simplifies views because it separates them in parts. A component is any functional and/or styling part of the app that you want to reuse in other pages or you want to insolate due to its complexity.

### lib directory

This directory is not in use yet. This is part of the default configuration of a svelte project but it has not been needed yet. This directory is meant to contain directories such as */components*, */styles* and so on. In our case we decide to have components in another place so that is why lib is not in use.

### routes directory

In ***routes*** we can find the screens and navigation structure. Svelte assigns each folder to a word between slashes in the browser, which creates a route. For example, if we have the folders *routes/docs* and *routes/docs/example*, that means that the route *"/docs/example"* exists in the app. Inside every folder we can find the exact same name for every file, which is ***+page.svelte***. This allows the framework to create routes and associate them to screens in a dynamic and confortable way.

:::important
Be advised: any folder without a ***+page.svelte*** file will not be considered a route, or will be considered a part of one. Following with the past ecample:

If you have *routes/docs*  and *routes/docs/example* directories, and you have *routes/docs/example/+page.svelte* file, your app will have a route */docs/example* that shows the content of *+page.svelte* file. However, the route */docs* will not show any content and your app will display a ***404 Not Found***.
:::

There are folders that have special meaning. If you see any folder named between brackets, that means it is an url param. For example, the folder name [target] is refering to an url param, in this case, target.

Let's see a full real example for a better understanding:

There are 3 folders:

+ routes
+ routes/export
+ routes/export/[target]

This means that in the app there is an url corresponding to the route */export/:target*

Let's supose that there is a file called **+page.svelte** inside *[target]* folder. That means that when the user goes to */export/:target*, he will find the screen defined in that *+page.svelte* file.

In this case, the user will find the same page whatever taget value is. In lucid chain case, this means that */export/itop* and */export/redmine* will lead to the same screen.

<div align="center">
![Routes structure](/img/structure/routesStrcuture.png)  
**Figure 3:** *Lucid chain routes directory structure.*
</div>

### stores directory

This directory is used to stablish and manage enviroment variables, global variables and contexts. In our case, we only use it for enviroment variable. There is no need to change its content. You will see here a single file named ***stores.js***. It contains enviroment variables assignations.

## Enviroment variables

Now let's cover enviroment variables. If you see what is inside .env.example, you will see the following:

```.env
VITE_BACKEND_API=
```

Lets talk about them and see what they do.

+ <u>**VITE_BACKEND_API:**</u> This is the url to Lucid chain`s backend API. ***Its default value is an empty string ('')***.

### VITE_BACKEND_API use and sense (only for developers)

We made a whole section about this enviroment variable because it is the weirdest of the project and it is a bit tricky to understand. By default its value is an empty string because in production mode Lucid chain's backend and frontend are on the same host, port and route. However, when you want to make changes in frontend, in order to make them visible in the same url ***(http://localhost:3000)***, you will have to run the command ***npm run build***. This is because of framework reasons and because of svelte handler is attached to the backend. Lets explain this better.

Svelte's framework works transalating *.svelte* files to *html* code so browsers can understand everything. This process is called ***traspilation***. When you run the command ***npm run build*** you are making Svelte traspile your code, inject enviroment variables and creating all routing logic. This is stored in ***build*** folder. Why is it important? Because there is a special thing called "handler". This handler ensures the routing and redirection logic, and it is imported in ***app.js*** file in backend. This way you make backend and frontend run in the same port and host. It is very important to understand this because **all your changes will not be shown unless you run *npm run build* command**. As you can see, this is a problem when you want to add new features or you are making changes because it can be a little annoying. To fix this, you have an special command, which is ***npm run dev***. This command updates your frontend everytime you save a file or make a change (as nodemon does). However, there is another problem. ***Your frontend will be running in http://localhost:5173***. This will confuse Lucid chain because all the http requests will be made to ***localhost:5173*** instead of ***localhost:3000*** (the backend). To fix that, we have ***VITE_BACKEND_API*** variable. If you want to test your Lucid chain and watch it interact with the backend your frontend .env file ***must*** look like this:

```.env
VITE_BACKEND_API="http://localhost:3000"
```

This way you will make correct requests to your backend and you will be able to see all your changes without running ***npm run build***.

<Alert>
In your local machine both production configuration and development configurations will work, but that ***DOES NOT MEAN*** it will work in your deployment enviroment. Please do not forget to set VITE_BACKEND_API to ***an empty string ("")*** when deploying Lucid chain. If you do not do that, your deployed frontend will make requests to the client's localhost:3000, and Lucid chain will not work.
</Alert>
